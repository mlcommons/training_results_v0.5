STARTING TIMING RUN AT 2018-11-15 06:06:22 PM
parallelism=28, random seed=1542333982, learning rate=0.003821, batch size=98304, beta1=0.783529, beta2=0.909003, max epoch=20, eps=1.45439E-07
unzip ml-20m.zip
Archive:  ml-20m.zip
  inflating: ml-20m/genome-scores.csv  
  inflating: ml-20m/genome-tags.csv  
  inflating: ml-20m/links.csv        
  inflating: ml-20m/movies.csv       
  inflating: ml-20m/ratings.csv      
  inflating: ml-20m/README.txt       
  inflating: ml-20m/tags.csv         
Start training
:::MLPv0.5.0 ncf 1542333989.968 (NeuralCFexample.scala:70) run_start
:::MLPv0.5.0 ncf 1542333989.972 (NeuralCFexample.scala:71) run_clear_caches
:::MLPv0.5.0 ncf 1542333990.001 (NeuralCFexample.scala:133) seed: 1542333982
2018-11-15 18:06:30 INFO  Engine$:107 - Detect bigdl.localMode is set. Run workload without spark
2018-11-15 18:06:30 INFO  ThreadPool$:86 - Set mkl threads to 1 on thread 1
:::MLPv0.5.0 ncf 1542333990.217 (NeuralCFexample.scala:138) opt_learning_rate: 0.003821
:::MLPv0.5.0 ncf 1542333990.217 (NeuralCFexample.scala:139) create_optim_method: {"name": "Adam", "lr": 0.003821, "beta1": 0.783529, "beta2": 0.909003, "eps": 1.45439E-7}
2018-11-15 18:06:30 INFO  EmbeddingAdam2$:335 - init power start
2018-11-15 18:06:30 INFO  EmbeddingAdam2$:342 - init power done
:::MLPv0.5.0 ncf 1542334028.409 (NeuralCFexample.scala:170) preproc_hp_num_eval: 999
:::MLPv0.5.0 ncf 1542334028.410 (NeuralCFexample.scala:171) preproc_hp_sample_eval_replacement
:::MLPv0.5.0 ncf 1542334031.541 (GenerateData.scala:187) preproc_hp_min_ratings: 20
2018-11-15 18:07:11 INFO  GenerateData$:216 - Compared with pytorch's test-ratings.csv, eval positive is different 18048 of 138493, so we use pytorch's test-rating.csv to stay the same with pytorch's test positive.
:::MLPv0.5.0 ncf 1542334031.854 (GenerateData.scala:219) input_hp_sample_train_replacement
:::MLPv0.5.0 ncf 1542334032.499 (GenerateData.scala:227) input_step_eval_neg_gen
:::MLPv0.5.0 ncf 1542334046.088 (NeuralCFexample.scala:186) model_hp_mf_dim: 64
:::MLPv0.5.0 ncf 1542334046.088 (NeuralCFexample.scala:187) model_hp_mlp_layer_sizes: "[256, 256, 128, 64]"
:::MLPv0.5.0 ncf 1542334051.678 (NeuralCFexample.scala:199) model_hp_loss_fn: "binary_cross_entropy"
2018-11-15 18:07:31 INFO  NCFOptimizer2$:384 - Clone 1 model...
2018-11-15 18:07:31 INFO  NCFOptimizer2$:384 - Clone 2 model...
2018-11-15 18:07:31 INFO  NCFOptimizer2$:384 - Clone 3 model...
2018-11-15 18:07:31 INFO  NCFOptimizer2$:384 - Clone 4 model...
2018-11-15 18:07:31 INFO  NCFOptimizer2$:384 - Clone 5 model...
2018-11-15 18:07:31 INFO  NCFOptimizer2$:384 - Clone 6 model...
2018-11-15 18:07:31 INFO  NCFOptimizer2$:384 - Clone 7 model...
2018-11-15 18:07:31 INFO  NCFOptimizer2$:384 - Clone 8 model...
2018-11-15 18:07:31 INFO  NCFOptimizer2$:384 - Clone 9 model...
2018-11-15 18:07:31 INFO  NCFOptimizer2$:384 - Clone 10 model...
2018-11-15 18:07:31 INFO  NCFOptimizer2$:384 - Clone 11 model...
2018-11-15 18:07:31 INFO  NCFOptimizer2$:384 - Clone 12 model...
2018-11-15 18:07:31 INFO  NCFOptimizer2$:384 - Clone 13 model...
2018-11-15 18:07:31 INFO  NCFOptimizer2$:384 - Clone 14 model...
2018-11-15 18:07:31 INFO  NCFOptimizer2$:384 - Clone 15 model...
2018-11-15 18:07:31 INFO  NCFOptimizer2$:384 - Clone 16 model...
2018-11-15 18:07:31 INFO  NCFOptimizer2$:384 - Clone 17 model...
2018-11-15 18:07:31 INFO  NCFOptimizer2$:384 - Clone 18 model...
2018-11-15 18:07:31 INFO  NCFOptimizer2$:384 - Clone 19 model...
2018-11-15 18:07:31 INFO  NCFOptimizer2$:384 - Clone 20 model...
2018-11-15 18:07:31 INFO  NCFOptimizer2$:384 - Clone 21 model...
2018-11-15 18:07:31 INFO  NCFOptimizer2$:384 - Clone 22 model...
2018-11-15 18:07:31 INFO  NCFOptimizer2$:384 - Clone 23 model...
2018-11-15 18:07:31 INFO  NCFOptimizer2$:384 - Clone 24 model...
2018-11-15 18:07:31 INFO  NCFOptimizer2$:384 - Clone 25 model...
2018-11-15 18:07:31 INFO  NCFOptimizer2$:384 - Clone 26 model...
2018-11-15 18:07:31 INFO  NCFOptimizer2$:384 - Clone 27 model...
2018-11-15 18:07:31 INFO  NCFOptimizer2$:384 - Clone 28 model...
2018-11-15 18:07:31 INFO  NCFOptimizer2$:384 - Clone 1 model...
2018-11-15 18:07:31 INFO  NCFOptimizer2$:384 - Clone 2 model...
2018-11-15 18:07:31 INFO  NCFOptimizer2$:384 - Clone 3 model...
2018-11-15 18:07:31 INFO  NCFOptimizer2$:384 - Clone 4 model...
2018-11-15 18:07:31 INFO  NCFOptimizer2$:384 - Clone 5 model...
2018-11-15 18:07:31 INFO  NCFOptimizer2$:384 - Clone 6 model...
2018-11-15 18:07:31 INFO  NCFOptimizer2$:384 - Clone 7 model...
2018-11-15 18:07:31 INFO  NCFOptimizer2$:384 - Clone 8 model...
2018-11-15 18:07:31 INFO  NCFOptimizer2$:384 - Clone 9 model...
2018-11-15 18:07:31 INFO  NCFOptimizer2$:384 - Clone 10 model...
2018-11-15 18:07:31 INFO  NCFOptimizer2$:384 - Clone 11 model...
2018-11-15 18:07:31 INFO  NCFOptimizer2$:384 - Clone 12 model...
2018-11-15 18:07:31 INFO  NCFOptimizer2$:384 - Clone 13 model...
2018-11-15 18:07:31 INFO  NCFOptimizer2$:384 - Clone 14 model...
2018-11-15 18:07:31 INFO  NCFOptimizer2$:384 - Clone 15 model...
2018-11-15 18:07:31 INFO  NCFOptimizer2$:384 - Clone 16 model...
2018-11-15 18:07:31 INFO  NCFOptimizer2$:384 - Clone 17 model...
2018-11-15 18:07:31 INFO  NCFOptimizer2$:384 - Clone 18 model...
2018-11-15 18:07:31 INFO  NCFOptimizer2$:384 - Clone 19 model...
2018-11-15 18:07:31 INFO  NCFOptimizer2$:384 - Clone 20 model...
2018-11-15 18:07:31 INFO  NCFOptimizer2$:384 - Clone 21 model...
2018-11-15 18:07:31 INFO  NCFOptimizer2$:384 - Clone 22 model...
2018-11-15 18:07:31 INFO  NCFOptimizer2$:384 - Clone 23 model...
2018-11-15 18:07:31 INFO  NCFOptimizer2$:384 - Clone 24 model...
2018-11-15 18:07:31 INFO  NCFOptimizer2$:384 - Clone 25 model...
2018-11-15 18:07:31 INFO  NCFOptimizer2$:384 - Clone 26 model...
2018-11-15 18:07:31 INFO  NCFOptimizer2$:384 - Clone 27 model...
2018-11-15 18:07:31 INFO  NCFOptimizer2$:384 - Clone 28 model...
:::MLPv0.5.0 ncf 1542334052.260 (NCFOptimizer2.scala:105) train_loop
:::MLPv0.5.0 ncf 1542334052.415 (NCFDataSet.scala:38) input_hp_num_neg: 4
2018-11-15 18:07:34 INFO  NCFOptimizer2$:117 - Generate epoch 1 data: 1961 ms
2018-11-15 18:07:34 INFO  NCFOptimizer2$:120 - model thread pool size is 1
:::MLPv0.5.0 ncf 1542334054.535 (NCFOptimizer2.scala:125) train_epoch: 0
2018-11-15 18:10:41 INFO  NCFOptimizer2$:251 - [Epoch 1 99385344/99385344][Iteration 1012][Wall Clock 186.725921132s] loss is 0.13037198968231678, training cost 186.725921132s. Throughput is 532252.5303262136 record / second. 
:::MLPv0.5.0 ncf 1542334241.340 (NCFOptimizer2.scala:312) eval_start: 0
2018-11-15 18:10:41 INFO  NCFOptimizer2$:313 - [Epoch 1 99385344/99385344][Iteration 1012][Wall Clock 186.725921132s] Validate model...
2018-11-15 18:11:31 INFO  NCFOptimizer2$:358 - [Epoch 1 99385344/99385344][Iteration 1012][Wall Clock 186.725921132s] HitRatio@10 is (HitRatio@10: 74258.0, count: 138493, Average HitRatio@10: 0.5361859)
:::MLPv0.5.0 ncf 1542334291.751 (NCFOptimizer2.scala:359) eval_size: {"epoch": 0, "value": 138493000}
:::MLPv0.5.0 ncf 1542334291.752 (NCFOptimizer2.scala:361) eval_hp_num_users: 138493
:::MLPv0.5.0 ncf 1542334291.752 (NCFOptimizer2.scala:362) eval_hp_num_neg: 999
:::MLPv0.5.0 ncf 1542334291.752 (NCFOptimizer2.scala:363) eval_accuracy: {"epoch": 0, "value": 0.5361859}
2018-11-15 18:11:31 INFO  NCFOptimizer2$:368 - [Epoch 1 99385344/99385344][Iteration 1012][Wall Clock 186.725921132s] Validation time cost: 50.412317112s. Throughput is 2747205.602398973 samples / sec
:::MLPv0.5.0 ncf 1542334291.752 (NCFOptimizer2.scala:370) eval_stop
:::MLPv0.5.0 ncf 1542334291.753 (NCFOptimizer2.scala:260) input_step_train_neg_gen
:::MLPv0.5.0 ncf 1542334291.753 (NCFDataSet.scala:38) input_hp_num_neg: 4
:::MLPv0.5.0 ncf 1542334293.695 (NCFOptimizer2.scala:263) train_epoch: 1
2018-11-15 18:11:33 INFO  NCFOptimizer2$:264 - Generate epoch 2 data: 1942 ms
2018-11-15 18:14:11 INFO  NCFOptimizer2$:251 - [Epoch 2 99385344/99385344][Iteration 2023][Wall Clock 344.477896078s] loss is 0.11326440476945468, training cost 157.751974946s. Throughput is 630010.1411346549 record / second. 
:::MLPv0.5.0 ncf 1542334451.509 (NCFOptimizer2.scala:312) eval_start: 1
2018-11-15 18:14:11 INFO  NCFOptimizer2$:313 - [Epoch 2 99385344/99385344][Iteration 2023][Wall Clock 344.477896078s] Validate model...
2018-11-15 18:15:03 INFO  NCFOptimizer2$:358 - [Epoch 2 99385344/99385344][Iteration 2023][Wall Clock 344.477896078s] HitRatio@10 is (HitRatio@10: 81279.0, count: 138493, Average HitRatio@10: 0.58688164)
:::MLPv0.5.0 ncf 1542334503.162 (NCFOptimizer2.scala:359) eval_size: {"epoch": 1, "value": 138493000}
:::MLPv0.5.0 ncf 1542334503.163 (NCFOptimizer2.scala:361) eval_hp_num_users: 138493
:::MLPv0.5.0 ncf 1542334503.163 (NCFOptimizer2.scala:362) eval_hp_num_neg: 999
:::MLPv0.5.0 ncf 1542334503.163 (NCFOptimizer2.scala:363) eval_accuracy: {"epoch": 1, "value": 0.58688164}
2018-11-15 18:15:03 INFO  NCFOptimizer2$:368 - [Epoch 2 99385344/99385344][Iteration 2023][Wall Clock 344.477896078s] Validation time cost: 51.654197991s. Throughput is 2681156.7188426857 samples / sec
:::MLPv0.5.0 ncf 1542334503.163 (NCFOptimizer2.scala:370) eval_stop
:::MLPv0.5.0 ncf 1542334503.163 (NCFOptimizer2.scala:260) input_step_train_neg_gen
:::MLPv0.5.0 ncf 1542334503.163 (NCFDataSet.scala:38) input_hp_num_neg: 4
:::MLPv0.5.0 ncf 1542334504.561 (NCFOptimizer2.scala:263) train_epoch: 2
2018-11-15 18:15:04 INFO  NCFOptimizer2$:264 - Generate epoch 3 data: 1398 ms
2018-11-15 18:17:44 INFO  NCFOptimizer2$:251 - [Epoch 3 99385344/99385344][Iteration 3034][Wall Clock 504.465668018s] loss is 0.10577543771692685, training cost 159.98777194s. Throughput is 621205.8758920173 record / second. 
:::MLPv0.5.0 ncf 1542334664.605 (NCFOptimizer2.scala:312) eval_start: 2
2018-11-15 18:17:44 INFO  NCFOptimizer2$:313 - [Epoch 3 99385344/99385344][Iteration 3034][Wall Clock 504.465668018s] Validate model...
2018-11-15 18:18:34 INFO  NCFOptimizer2$:358 - [Epoch 3 99385344/99385344][Iteration 3034][Wall Clock 504.465668018s] HitRatio@10 is (HitRatio@10: 83858.0, count: 138493, Average HitRatio@10: 0.6055035)
:::MLPv0.5.0 ncf 1542334714.820 (NCFOptimizer2.scala:359) eval_size: {"epoch": 2, "value": 138493000}
:::MLPv0.5.0 ncf 1542334714.820 (NCFOptimizer2.scala:361) eval_hp_num_users: 138493
:::MLPv0.5.0 ncf 1542334714.820 (NCFOptimizer2.scala:362) eval_hp_num_neg: 999
:::MLPv0.5.0 ncf 1542334714.820 (NCFOptimizer2.scala:363) eval_accuracy: {"epoch": 2, "value": 0.6055035}
2018-11-15 18:18:34 INFO  NCFOptimizer2$:368 - [Epoch 3 99385344/99385344][Iteration 3034][Wall Clock 504.465668018s] Validation time cost: 50.214972118s. Throughput is 2758002.128818388 samples / sec
:::MLPv0.5.0 ncf 1542334714.821 (NCFOptimizer2.scala:370) eval_stop
:::MLPv0.5.0 ncf 1542334714.821 (NCFOptimizer2.scala:260) input_step_train_neg_gen
:::MLPv0.5.0 ncf 1542334714.821 (NCFDataSet.scala:38) input_hp_num_neg: 4
:::MLPv0.5.0 ncf 1542334716.084 (NCFOptimizer2.scala:263) train_epoch: 3
2018-11-15 18:18:36 INFO  NCFOptimizer2$:264 - Generate epoch 4 data: 1263 ms
2018-11-15 18:21:13 INFO  NCFOptimizer2$:251 - [Epoch 4 99385344/99385344][Iteration 4045][Wall Clock 661.928492716s] loss is 0.09764550173921245, training cost 157.462824698s. Throughput is 631167.0338101228 record / second. 
:::MLPv0.5.0 ncf 1542334873.601 (NCFOptimizer2.scala:312) eval_start: 3
2018-11-15 18:21:13 INFO  NCFOptimizer2$:313 - [Epoch 4 99385344/99385344][Iteration 4045][Wall Clock 661.928492716s] Validate model...
2018-11-15 18:22:03 INFO  NCFOptimizer2$:358 - [Epoch 4 99385344/99385344][Iteration 4045][Wall Clock 661.928492716s] HitRatio@10 is (HitRatio@10: 85883.0, count: 138493, Average HitRatio@10: 0.62012523)
:::MLPv0.5.0 ncf 1542334923.873 (NCFOptimizer2.scala:359) eval_size: {"epoch": 3, "value": 138493000}
:::MLPv0.5.0 ncf 1542334923.874 (NCFOptimizer2.scala:361) eval_hp_num_users: 138493
:::MLPv0.5.0 ncf 1542334923.874 (NCFOptimizer2.scala:362) eval_hp_num_neg: 999
:::MLPv0.5.0 ncf 1542334923.874 (NCFOptimizer2.scala:363) eval_accuracy: {"epoch": 3, "value": 0.62012523}
2018-11-15 18:22:03 INFO  NCFOptimizer2$:368 - [Epoch 4 99385344/99385344][Iteration 4045][Wall Clock 661.928492716s] Validation time cost: 50.272546222s. Throughput is 2754843.5559325903 samples / sec
:::MLPv0.5.0 ncf 1542334923.874 (NCFOptimizer2.scala:370) eval_stop
:::MLPv0.5.0 ncf 1542334923.875 (NCFOptimizer2.scala:260) input_step_train_neg_gen
:::MLPv0.5.0 ncf 1542334923.875 (NCFDataSet.scala:38) input_hp_num_neg: 4
:::MLPv0.5.0 ncf 1542334925.229 (NCFOptimizer2.scala:263) train_epoch: 4
2018-11-15 18:22:05 INFO  NCFOptimizer2$:264 - Generate epoch 5 data: 1354 ms
2018-11-15 18:24:42 INFO  NCFOptimizer2$:251 - [Epoch 5 99385344/99385344][Iteration 5056][Wall Clock 819.046260124s] loss is 0.09467929042875767, training cost 157.117767408s. Throughput is 632553.1837651327 record / second. 
:::MLPv0.5.0 ncf 1542335082.401 (NCFOptimizer2.scala:312) eval_start: 4
2018-11-15 18:24:42 INFO  NCFOptimizer2$:313 - [Epoch 5 99385344/99385344][Iteration 5056][Wall Clock 819.046260124s] Validate model...
2018-11-15 18:25:32 INFO  NCFOptimizer2$:358 - [Epoch 5 99385344/99385344][Iteration 5056][Wall Clock 819.046260124s] HitRatio@10 is (HitRatio@10: 86847.0, count: 138493, Average HitRatio@10: 0.62708586)
:::MLPv0.5.0 ncf 1542335132.651 (NCFOptimizer2.scala:359) eval_size: {"epoch": 4, "value": 138493000}
:::MLPv0.5.0 ncf 1542335132.651 (NCFOptimizer2.scala:361) eval_hp_num_users: 138493
:::MLPv0.5.0 ncf 1542335132.651 (NCFOptimizer2.scala:362) eval_hp_num_neg: 999
:::MLPv0.5.0 ncf 1542335132.651 (NCFOptimizer2.scala:363) eval_accuracy: {"epoch": 4, "value": 0.62708586}
2018-11-15 18:25:32 INFO  NCFOptimizer2$:368 - [Epoch 5 99385344/99385344][Iteration 5056][Wall Clock 819.046260124s] Validation time cost: 50.249758656s. Throughput is 2756092.839133735 samples / sec
:::MLPv0.5.0 ncf 1542335132.652 (NCFOptimizer2.scala:370) eval_stop
:::MLPv0.5.0 ncf 1542335132.652 (NCFOptimizer2.scala:260) input_step_train_neg_gen
:::MLPv0.5.0 ncf 1542335132.652 (NCFDataSet.scala:38) input_hp_num_neg: 4
:::MLPv0.5.0 ncf 1542335133.926 (NCFOptimizer2.scala:263) train_epoch: 5
2018-11-15 18:25:33 INFO  NCFOptimizer2$:264 - Generate epoch 6 data: 1274 ms
2018-11-15 18:28:11 INFO  NCFOptimizer2$:251 - [Epoch 6 99385344/99385344][Iteration 6067][Wall Clock 976.683940764s] loss is 0.09264722599514894, training cost 157.63768064s. Throughput is 630466.9264131594 record / second. 
:::MLPv0.5.0 ncf 1542335291.618 (NCFOptimizer2.scala:312) eval_start: 5
2018-11-15 18:28:11 INFO  NCFOptimizer2$:313 - [Epoch 6 99385344/99385344][Iteration 6067][Wall Clock 976.683940764s] Validate model...
2018-11-15 18:29:02 INFO  NCFOptimizer2$:358 - [Epoch 6 99385344/99385344][Iteration 6067][Wall Clock 976.683940764s] HitRatio@10 is (HitRatio@10: 87902.0, count: 138493, Average HitRatio@10: 0.6347036)
:::MLPv0.5.0 ncf 1542335342.008 (NCFOptimizer2.scala:359) eval_size: {"epoch": 5, "value": 138493000}
:::MLPv0.5.0 ncf 1542335342.009 (NCFOptimizer2.scala:361) eval_hp_num_users: 138493
:::MLPv0.5.0 ncf 1542335342.009 (NCFOptimizer2.scala:362) eval_hp_num_neg: 999
:::MLPv0.5.0 ncf 1542335342.009 (NCFOptimizer2.scala:363) eval_accuracy: {"epoch": 5, "value": 0.6347036}
2018-11-15 18:29:02 INFO  NCFOptimizer2$:368 - [Epoch 6 99385344/99385344][Iteration 6067][Wall Clock 976.683940764s] Validation time cost: 50.390114715s. Throughput is 2748416.0491258763 samples / sec
:::MLPv0.5.0 ncf 1542335342.009 (NCFOptimizer2.scala:370) eval_stop
:::MLPv0.5.0 ncf 1542335342.009 (NCFOptimizer2.scala:260) input_step_train_neg_gen
:::MLPv0.5.0 ncf 1542335342.009 (NCFDataSet.scala:38) input_hp_num_neg: 4
:::MLPv0.5.0 ncf 1542335343.341 (NCFOptimizer2.scala:263) train_epoch: 6
2018-11-15 18:29:03 INFO  NCFOptimizer2$:264 - Generate epoch 7 data: 1332 ms
2018-11-15 18:31:40 INFO  NCFOptimizer2$:251 - [Epoch 7 99385344/99385344][Iteration 7078][Wall Clock 1133.503933759s] loss is 0.089667570112007, training cost 156.819992995s. Throughput is 633754.2943466958 record / second. 
:::MLPv0.5.0 ncf 1542335500.214 (NCFOptimizer2.scala:312) eval_start: 6
2018-11-15 18:31:40 INFO  NCFOptimizer2$:313 - [Epoch 7 99385344/99385344][Iteration 7078][Wall Clock 1133.503933759s] Validate model...
2018-11-15 18:32:30 INFO  NCFOptimizer2$:358 - [Epoch 7 99385344/99385344][Iteration 7078][Wall Clock 1133.503933759s] HitRatio@10 is (HitRatio@10: 87052.0, count: 138493, Average HitRatio@10: 0.6285661)
:::MLPv0.5.0 ncf 1542335550.454 (NCFOptimizer2.scala:359) eval_size: {"epoch": 6, "value": 138493000}
:::MLPv0.5.0 ncf 1542335550.455 (NCFOptimizer2.scala:361) eval_hp_num_users: 138493
:::MLPv0.5.0 ncf 1542335550.455 (NCFOptimizer2.scala:362) eval_hp_num_neg: 999
:::MLPv0.5.0 ncf 1542335550.455 (NCFOptimizer2.scala:363) eval_accuracy: {"epoch": 6, "value": 0.6285661}
2018-11-15 18:32:30 INFO  NCFOptimizer2$:368 - [Epoch 7 99385344/99385344][Iteration 7078][Wall Clock 1133.503933759s] Validation time cost: 50.240560101s. Throughput is 2756597.452766921 samples / sec
:::MLPv0.5.0 ncf 1542335550.455 (NCFOptimizer2.scala:370) eval_stop
:::MLPv0.5.0 ncf 1542335550.455 (NCFOptimizer2.scala:260) input_step_train_neg_gen
:::MLPv0.5.0 ncf 1542335550.456 (NCFDataSet.scala:38) input_hp_num_neg: 4
:::MLPv0.5.0 ncf 1542335551.822 (NCFOptimizer2.scala:263) train_epoch: 7
2018-11-15 18:32:31 INFO  NCFOptimizer2$:264 - Generate epoch 8 data: 1367 ms
2018-11-15 18:35:10 INFO  NCFOptimizer2$:251 - [Epoch 8 99385344/99385344][Iteration 8089][Wall Clock 1291.812377225s] loss is 0.0874182962413345, training cost 158.308443466s. Throughput is 627795.5984157285 record / second. 
:::MLPv0.5.0 ncf 1542335710.183 (NCFOptimizer2.scala:312) eval_start: 7
2018-11-15 18:35:10 INFO  NCFOptimizer2$:313 - [Epoch 8 99385344/99385344][Iteration 8089][Wall Clock 1291.812377225s] Validate model...
2018-11-15 18:36:00 INFO  NCFOptimizer2$:358 - [Epoch 8 99385344/99385344][Iteration 8089][Wall Clock 1291.812377225s] HitRatio@10 is (HitRatio@10: 88364.0, count: 138493, Average HitRatio@10: 0.63803947)
:::MLPv0.5.0 ncf 1542335760.458 (NCFOptimizer2.scala:359) eval_size: {"epoch": 7, "value": 138493000}
:::MLPv0.5.0 ncf 1542335760.458 (NCFOptimizer2.scala:361) eval_hp_num_users: 138493
:::MLPv0.5.0 ncf 1542335760.459 (NCFOptimizer2.scala:362) eval_hp_num_neg: 999
:::MLPv0.5.0 ncf 1542335760.459 (NCFOptimizer2.scala:363) eval_accuracy: {"epoch": 7, "value": 0.63803947}
2018-11-15 18:36:00 INFO  NCFOptimizer2$:368 - [Epoch 8 99385344/99385344][Iteration 8089][Wall Clock 1291.812377225s] Validation time cost: 50.275269223s. Throughput is 2754694.34854149 samples / sec
:::MLPv0.5.0 ncf 1542335760.459 (NCFOptimizer2.scala:370) eval_stop
:::MLPv0.5.0 ncf 1542335760.459 (NeuralCFexample.scala:507) eval_target: 0.635
:::MLPv0.5.0 ncf 1542335760.459 (NeuralCFexample.scala:509) run_stop: {"success": true}
:::MLPv0.5.0 ncf 1542335760.497 (NeuralCFexample.scala:234) run_final
Finish training in 1772 seconds
ENDING TIMING RUN AT 2018-11-15 06:36:00 PM
RESULT,recommendation,1542333982,1778,rpremsee,2018-11-15 06:06:22 PM
